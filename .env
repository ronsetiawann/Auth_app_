# ==========================================
# STRADE Auth Service - Environment Variables
# ==========================================

# ==========================================
# Application Profile
# ==========================================
SPRING_PROFILES_ACTIVE=dev

# ==========================================
# Database Configuration (SQL Server)
# ==========================================
DB_HOST=172.24.25.33
DB_PORT=1433
DB_NAME=S21_RT_PLUS_IDXMOBILE
DB_USERNAME=s21rt
DB_PASSWORD=diehards21rt

# Database Connection Pool (HikariCP)
DB_POOL_MAX_SIZE=20
DB_POOL_MIN_IDLE=5
DB_POOL_CONNECTION_TIMEOUT=30000
DB_POOL_IDLE_TIMEOUT=600000
DB_POOL_MAX_LIFETIME=1800000

# ==========================================
# Redis Configuration
# ==========================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=YourRedisPassword123!
REDIS_DATABASE=0
REDIS_TIMEOUT=2000ms

# Redis Connection Pool (Lettuce)
REDIS_POOL_MAX_ACTIVE=20
REDIS_POOL_MAX_IDLE=10
REDIS_POOL_MIN_IDLE=5
REDIS_POOL_MAX_WAIT=2000ms

# Cache TTL (30 minutes in milliseconds)
CACHE_TTL_MILLISECONDS=1800000

# ==========================================
# JWT Configuration
# ==========================================
# Path to RSA private key (for signing)
#JWT_PRIVATE_KEY_PATH=file:/etc/strade/keys/private_key.pem
JWT_PRIVATE_KEY_PATH=classpath:keys/private_key.pem
# Path to RSA public key (for verification)
#JWT_PUBLIC_KEY_PATH=file:/etc/strade/keys/public_key.pem
JWT_PUBLIC_KEY_PATH=classpath:keys/public_key.pem

# Token Expiration
JWT_ACCESS_TOKEN_EXPIRATION_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRATION_DAYS=30

# ==========================================
# Security Configuration
# ==========================================
# CRITICAL: Generate using: openssl rand -base64 32
ENCRYPTION_KEY=nzWE/C1aTm/wIDAJfud40BPfj1gpHobDgCaLr8odEP0=

# Login retry limit
SECURITY_MAX_LOGIN_RETRY=5

# Broker login time restriction
SECURITY_BROKER_LOGIN_HOUR=8
SECURITY_BROKER_LOGIN_MINUTE=0

# ==========================================
# MFA (Multi-Factor Authentication) Configuration
# ==========================================
# Global MFA enforcement (true/false)
MFA_ENFORCED=true

# OTP Settings
MFA_OTP_LENGTH=6
MFA_OTP_TTL_SECONDS=300
MFA_OTP_MAX_ATTEMPTS=5

# TOTP (Time-based OTP) Settings
MFA_TOTP_ISSUER=STRADE
MFA_TOTP_DIGITS=6
MFA_TOTP_PERIOD_SECONDS=30
MFA_TOTP_ALGORITHM=SHA1
MFA_TOTP_WINDOW=1

# Trusted Device Settings
MFA_TRUSTED_DEVICE_TTL_DAYS=90
MFA_TRUSTED_DEVICE_MAX_DEVICES=3
MFA_TRUSTED_DEVICE_SEND_EMAIL=true

# Backup Codes
MFA_BACKUP_CODES_COUNT=10

# ==========================================
# Rate Limiting Configuration
# ==========================================
# Login rate limit
RATE_LIMIT_LOGIN_MAX_ATTEMPTS=5
RATE_LIMIT_LOGIN_WINDOW_SECONDS=300

# OTP request rate limit
RATE_LIMIT_OTP_MAX_REQUESTS=3
RATE_LIMIT_OTP_WINDOW_SECONDS=300

# TOTP verification rate limit
RATE_LIMIT_TOTP_MAX_ATTEMPTS=5
RATE_LIMIT_TOTP_WINDOW_SECONDS=300

# ==========================================
# Session Configuration
# ==========================================
# Inactive session timeout (in minutes)
SESSION_INACTIVE_THRESHOLD_MINUTES=30

# ==========================================
# Email Configuration (SMTP)
# ==========================================
MAIL_HOST=sandbox.smtp.mailtrap.io
MAIL_PORT=587
MAIL_USERNAME=8ed1b644362c4d
MAIL_PASSWORD=1cbe16d6cc54c5
MAIL_FROM=noreply@strade.com
MAIL_FROM_NAME=STRADE Auth Service

# SMTP Settings
MAIL_SMTP_AUTH=true
MAIL_SMTP_STARTTLS_ENABLE=true
MAIL_SMTP_STARTTLS_REQUIRED=true
MAIL_SMTP_CONNECTION_TIMEOUT=5000
MAIL_SMTP_TIMEOUT=5000
MAIL_SMTP_WRITE_TIMEOUT=5000

# ==========================================
# SMS Configuration (Twilio)
# ==========================================
SMS_PROVIDER=twilio

# Twilio Credentials
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=your_twilio_auth_token_here
TWILIO_FROM_NUMBER=+12345678900
TWILIO_BASE_URL=https://api.twilio.com/2010-04-01

# Alternative SMS Providers (Optional)
# Infobip
INFOBIP_API_KEY=your_infobip_api_key_here
INFOBIP_BASE_URL=https://api.infobip.com
INFOBIP_SENDER=STRADE

# Zenziva (Indonesia)
ZENZIVA_USER_KEY=your_zenziva_user_key_here
ZENZIVA_PASS_KEY=your_zenziva_pass_key_here
ZENZIVA_BASE_URL=https://console.zenziva.net/reguler/api

# ==========================================
# Mekari Qontak Configuration (WhatsApp)
# ==========================================
MEKARI_CLIENT_ID=fpacKJp1mkAEdh4A
MEKARI_CLIENT_SECRET=h88QJkCgECPZmuh4bXTjtm5ZkUO2GBS5
MEKARI_BASE_URL=https://api.mekari.com

# WhatsApp Template Settings
MEKARI_WHATSAPP_TEMPLATE_ID=d202a276-b483-4481-9b93-58721625c982
MEKARI_WHATSAPP_CHANNEL_ID=968a2ba0-3d9c-48bb-a281-9a3021207120

# ==========================================
# Firebase Configuration implementation in idxm
# ==========================================
# Path to Firebase service account JSON
FIREBASE_CREDENTIALS_PATH=file:/etc/strade/firebase/service-account.json
# Or base64 encoded credentials
FIREBASE_CREDENTIALS_BASE64=your_base64_encoded_json_here

# ==========================================
# Scheduler Configuration
# ==========================================
# Master scheduler switch
SCHEDULER_ENABLED=fasle

# Token Cleanup Scheduler
SCHEDULER_TOKEN_CLEANUP_ENABLED=true
SCHEDULER_TOKEN_CLEANUP_EXPIRED_DENYLIST=true
SCHEDULER_TOKEN_CLEANUP_REVOKED_REFRESH_TOKENS=true
SCHEDULER_TOKEN_CLEANUP_EXPIRED_OTP_CHALLENGES=true
SCHEDULER_TOKEN_CLEANUP_OLD_OTP_CHALLENGES=true
SCHEDULER_TOKEN_CLEANUP_COMPREHENSIVE_CLEANUP=true

# Session Cleanup Scheduler
SCHEDULER_SESSION_CLEANUP_ENABLED=true
SCHEDULER_SESSION_CLEANUP_MARK_INACTIVE=true
SCHEDULER_SESSION_CLEANUP_CLEANUP_EXPIRED=true

# Security Monitor Scheduler
SCHEDULER_SECURITY_MONITOR_ENABLED=false
SCHEDULER_SECURITY_MONITOR_MONITOR=false
SCHEDULER_SECURITY_MONITOR_LOGIN_FAILURES=false
SCHEDULER_SECURITY_MONITOR_TOKEN_REUSE=false

# Notification Processor Scheduler
SCHEDULER_NOTIFICATION_PROCESSOR_ENABLED=true
SCHEDULER_NOTIFICATION_PROCESSOR_PROCESS_PENDING=true
SCHEDULER_NOTIFICATION_PROCESSOR_CLEANUP_OLD=true

# Health Check Scheduler
SCHEDULER_HEALTH_CHECK_ENABLED=true
SCHEDULER_HEALTH_CHECK_DATABASE=true
SCHEDULER_HEALTH_CHECK_REDIS=true

# Scheduler Thread Pool Size
SCHEDULER_POOL_SIZE=5

# ==========================================
# Async Configuration
# ==========================================
ASYNC_POOL_CORE_SIZE=5
ASYNC_POOL_MAX_SIZE=10
ASYNC_POOL_QUEUE_CAPACITY=100

# ==========================================
# Server Configuration
# ==========================================
SERVER_PORT=8099

# SSL Configuration (Optional - for HTTPS)
SSL_ENABLED=false
SSL_KEYSTORE_PATH=file:/etc/strade/ssl/keystore.p12
SSL_KEYSTORE_PASSWORD=your_keystore_password
SSL_KEYSTORE_TYPE=PKCS12
SSL_KEY_ALIAS=strade-auth

# ==========================================
# Logging Configuration
# ==========================================
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_APP=DEBUG
LOG_LEVEL_SPRING_WEB=INFO
LOG_LEVEL_SPRING_SECURITY=DEBUG
LOG_LEVEL_HIBERNATE_SQL=WARN
LOG_LEVEL_HIBERNATE_BINDER=WARN

# Log File Settings
LOG_FILE_PATH=logs/auth-service.log
LOG_FILE_MAX_SIZE=10MB
LOG_FILE_MAX_HISTORY=30

# ==========================================
# Actuator & Monitoring Configuration
# ==========================================
# Exposed actuator endpoints (comma-separated)
ACTUATOR_ENDPOINTS=health,info,metrics,prometheus

# Health endpoint detail level (always/when-authorized/never)
ACTUATOR_HEALTH_SHOW_DETAILS=when-authorized

# Prometheus metrics export
PROMETHEUS_ENABLED=true

# ==========================================
# CORS Configuration (Optional)
# ==========================================
CORS_ALLOWED_ORIGINS=https://app.strade.com,https://mobile.strade.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Authorization,Content-Type,X-Device-ID,X-Channel
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=3600

# ==========================================
# Development/Testing Only
# ==========================================
# Disable MFA for development
DEV_MFA_BYPASS=false

# Use H2 in-memory database for testing
TEST_USE_H2=false

# Enable SQL logging in development
DEV_SHOW_SQL=false